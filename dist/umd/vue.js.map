{"version":3,"file":"vue.js","sources":["../../myVue/data/array.js","../../myVue/myVue.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype;\r\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\r\n\r\nlet methods = [\r\n  'push',\r\n  'pop',\r\n  'unshift',\r\n  'shift',\r\n  'splice',\r\n  'reverse',\r\n  'sort'\r\n]\r\n\r\nmethods.forEach(method => {\r\n  arrayMethods[method] = function () {\r\n    console.log('数组方法被调用了');\r\n    const result = oldArrayProtoMethods[method].apply(this, arguments);\r\n    return result;\r\n  }\r\n})","import { arrayMethods } from \"./data/array\";\r\n\r\nlet Vue = function (options) {\r\n  this._init(options)\r\n}\r\n\r\nVue.prototype._init = function (options) {\r\n  let vm = this;\r\n  vm.$options = options;\r\n  initState(vm);\r\n}\r\n\r\nconst initState = function initState (vm) {\r\n  const opts = vm.$options;\r\n  if (opts.props) {\r\n    initProps(vm);\r\n  }\r\n  if (opts.methods) {\r\n    initMethods(vm);\r\n  }\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction initProps (vm) {\r\n\r\n}\r\n\r\nfunction initMethods (vm) {\r\n\r\n}\r\n\r\nfunction initData (vm) {\r\n  let data = vm.$options.data;\r\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data;\r\n\r\n  // 数据的劫持方案\r\n  // 数组 单独处理的\r\n  observe(data);\r\n}\r\n\r\nclass Observe {\r\n  constructor(value) {\r\n    if (Array.isArray(value)) {\r\n      // 我希望调用 push shift unshift splice sort reverse pop\r\n      value.__proto__ = arrayMethods;\r\n      // 观测\r\n      this.observeArray(value);\r\n    } else {\r\n      this.walk(value);\r\n    }\r\n  }\r\n  walk (data) {\r\n    let keys = Object.keys(data);\r\n    keys.forEach(key => {\r\n      defineReactive(data, key, data[key]);\r\n    })\r\n  }\r\n  observeArray (value) {\r\n    value.forEach(item => {\r\n      observe(item);\r\n    })\r\n  }\r\n}\r\n\r\nfunction defineReactive (data, key, value) {\r\n  observe(value);\r\n  Object.defineProperty(data, key, {\r\n    get () {\r\n      console.log('用户获取值了')\r\n      return value;\r\n    },\r\n    set (newValue) {\r\n      console.log('用户设置值了');\r\n      if (newValue === value) return;\r\n      observe(newValue);\r\n      value = newValue;\r\n    }\r\n  })\r\n}\r\n\r\nfunction observe (data) {\r\n  if (typeof data !== 'object' || data == null) return;\r\n  return new Observe(data)\r\n}\r\n\r\nexport default Vue;"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","console","log","result","apply","arguments","Vue","options","_init","vm","$options","initState","opts","props","data","initData","_data","call","observe","Observe","value","isArray","__proto__","observeArray","walk","keys","key","defineReactive","item","defineProperty","get","set","newValue"],"mappings":"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"}