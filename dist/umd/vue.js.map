{"version":3,"file":"vue.js","sources":["../../myVue/data/array.js","../../myVue/myVue.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype;\r\nconsole.log(oldArrayProtoMethods)\r\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\r\nconsole.log(arrayMethods);\r\n\r\nlet methods = [\r\n  'push',\r\n  'pop',\r\n  'unshift',\r\n  'shift',\r\n  'splice',\r\n  'reverse',\r\n  'sort'\r\n]\r\n\r\nmethods.forEach(method => {\r\n  arrayMethods[method] = function () {\r\n    oldArrayProtoMethods[method].apply(this, arguments)\r\n  }\r\n})","import { arrayMethods } from \"./data/array\";\r\n\r\nlet Vue = function (options) {\r\n  this._init(options)\r\n}\r\n\r\nVue.prototype._init = function (options) {\r\n  let vm = this;\r\n  vm.$options = options;\r\n  initState(vm);\r\n}\r\n\r\nconst initState = function initState (vm) {\r\n  const opts = vm.$options;\r\n  if (opts.props) {\r\n    initProps(vm);\r\n  }\r\n  if (opts.methods) {\r\n    initMethods(vm);\r\n  }\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n}\r\n\r\nfunction initProps (vm) {\r\n\r\n}\r\n\r\nfunction initMethods (vm) {\r\n\r\n}\r\n\r\nfunction initData (vm) {\r\n  let data = vm.$options.data;\r\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data;\r\n\r\n  // 数据的劫持方案\r\n  // 数组 单独处理的\r\n  observe(data);\r\n}\r\n\r\nclass Observe {\r\n  constructor(value) {\r\n    if (Array.isArray(value)) {\r\n      // 我希望调用 push shift unshift splice sort reverse pop\r\n      value.__proto__ = arrayMethods;\r\n    } else {\r\n      this.walk(value);\r\n    }\r\n  }\r\n  walk (data) {\r\n    let keys = Object.keys(data);\r\n    keys.forEach(key => {\r\n      defineReactive(data, key, data[key]);\r\n    })\r\n  }\r\n}\r\n\r\nfunction defineReactive (data, key, value) {\r\n  observe(value);\r\n  Object.defineProperty(data, key, {\r\n    get () {\r\n      console.log('用户获取值了')\r\n      return value;\r\n    },\r\n    set (newValue) {\r\n      console.log('用户设置值了');\r\n      if (newValue === value) return;\r\n      observe(newValue);\r\n      value = newValue;\r\n    }\r\n  })\r\n}\r\n\r\nfunction observe (data) {\r\n  if (typeof data !== 'object' || data == null) return;\r\n  return new Observe(data)\r\n}\r\n\r\nexport default Vue;"],"names":["oldArrayProtoMethods","Array","prototype","console","log","arrayMethods","Object","create","methods","forEach","method","apply","arguments","Vue","options","_init","vm","$options","initState","opts","props","data","initData","_data","call","observe","Observe","value","isArray","__proto__","walk","keys","key","defineReactive","defineProperty","get","set","newValue"],"mappings":"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"}